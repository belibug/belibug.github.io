<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Introducing PowerShell Templating Engine - Mold | Beli's blog</title>
<meta name=keywords content="guide,tool,psgallery,code,powershell"><meta name=description content="The Missing Piece in Your PowerShell Toolkit, the Intuitive Template Engine üõ†Ô∏è"><meta name=author content="Manjunath Beli"><link rel=canonical href=https://blog.belibug.com/post/ps-mold/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.belibug.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.belibug.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.belibug.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.belibug.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.belibug.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.belibug.com/post/ps-mold/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EKBBBJE5PX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EKBBBJE5PX")}</script><meta property="og:title" content="Introducing PowerShell Templating Engine - Mold"><meta property="og:description" content="The Missing Piece in Your PowerShell Toolkit, the Intuitive Template Engine üõ†Ô∏è"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.belibug.com/post/ps-mold/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-07-12T17:36:31-03:00"><meta property="article:modified_time" content="2024-07-12T17:36:31-03:00"><meta property="og:site_name" content="Beli's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introducing PowerShell Templating Engine - Mold"><meta name=twitter:description content="The Missing Piece in Your PowerShell Toolkit, the Intuitive Template Engine üõ†Ô∏è"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.belibug.com/post/"},{"@type":"ListItem","position":2,"name":"Introducing PowerShell Templating Engine - Mold","item":"https://blog.belibug.com/post/ps-mold/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introducing PowerShell Templating Engine - Mold","name":"Introducing PowerShell Templating Engine - Mold","description":"The Missing Piece in Your PowerShell Toolkit, the Intuitive Template Engine üõ†Ô∏è","keywords":["guide","tool","psgallery","code","powershell"],"articleBody":"Introducing Mold - The Missing PowerShell Templating Engine Mold is PowerShell template \u0026 scaffolding engine that lets you effortlessly craft templates for any language (not limited to PowerShell), on any platform. üöÄ Deploy in a flash with interactive prompts or answer files ‚Äì your choice!\nReady to see Mold work in action? Here‚Äôs a sneak peek of what deploying a template looks like:\nüå± What‚Äôs Templating \u0026 Why Should You Care? Think of templates as blueprints for your code. They‚Äôre pre-formatted files with placeholders for variables, like names, dates, blocks of code. When you use a template, you simply fill in the blanks, and voil√† ‚Äì you‚Äôve got a customized script or project ready to go!\nWhy is this awesome?\nSave Time: No more writing the same boilerplate code over and over. Consistency: Templates help ensure your projects follow best practices and maintain a uniform style. Scalability: Easily create multiple projects or files from a single template. Flexibility: Customize your templates to fit your specific needs. Some Practical Use Cases\nNew modules with consistent boilerplate code. Quickly generate complex configuration files from pre-defined templates. Build project scaffolding with a few simple commands. Standardize documentation across your PowerShell projects. Easy template for Minutes of meeting and personal notes. Mold is a template engine, a powerful tool that acts as a processor for your templates and data. This Wikipedia article explains the concept of templating in depth.\nIn short, templating is a superpower for developers, boosting productivity and reducing errors. And with Mold, harnessing that power is easier than ever before!\nüöÄ Can‚Äôt Wait to Get Started? If you‚Äôre itching to give Mold a whirl, you can grab the module from the PowerShell Gallery and explore the source code on GitHub right now!\nBut wait, there‚Äôs more! If you‚Äôre ready to dive deeper, stick around and join me as I walk you through the step-by-step process of building a Mold template from the ground up. We‚Äôll cover all the key features and even deploy the template to see it in action. Let‚Äôs get started!\nThe Why? Mold began as my own little side project to scratch a personal templating itch. But, it quickly blossomed into something bigger ‚Äì a solution to a longstanding gap in the PowerShell ecosystem. Now, I know what you‚Äôre thinking: ‚ÄúWe‚Äôve got Plaster, right?‚Äù And yes, while Plaster has served the community well, I believe there‚Äôs room for a fresh approach. Let‚Äôs dive into why I think a new templating engine is not only welcome but necessary. üòâ\nWhile Plaster‚Äôs deep ties to PowerShell offer undeniable advantages, they also come with certain constraints. I aimed to create something more versatile ‚Äì a tool that treats text as its playground, regardless of language.\nLet‚Äôs face it, Plaster‚Äôs PowerShell 7 support is‚Ä¶ well, underwhelming. üòû It‚Äôs been gathering dust for years and demands those long, convoluted XML files that nobody enjoys writing.\nThe How? ü§î Still Here? Alright, I see you‚Äôre intrigued. Perhaps you‚Äôre even starting to agree that a fresh templating engine is not that bad idea after all. Let‚Äôs unveil what Mold brings to the table, shall we?\nYou can find a deep dive into Mold‚Äôs concepts, installation, usage, and even some pro tips on our GitHub repository. I encourage you to even scour through the actual code to get a feel for how Mold works under the hood.\nThis blog post will focus on a hands-on walkthrough of crafting and deploying your very own Mold templates. So, buckle up and get ready to mold some code!\nExample Project - PowerShell Script Template for new Scripts I spin up new PowerShell scripts all the time, whether just for quickly experimenting and testing things out, or for projects that I know will be around for a while. There‚Äôs a few basic things that I like all my scripts to have. - Daniel Schroeder\nLets tackle this challenge. I wanted a bare-bones script template that delivers the essentials:\nscript.ps1: A file with a name that perfectly matches its purpose, along with a basic script structure. Docs : A dedicated folder to hold extra files related to script. README.md: A markdown file within the Docs folder for documenting the script‚Äôs purpose/instruction. NOTE: This example is intentionally simple (although less practical), designed to illustrate Mold‚Äôs core concepts and functionality. In real-world scenarios, your templates can be far more complex and tailored to your specific needs.\nLet your imagination run wild! üåà Think about the repetitive tasks in your PowerShell projects. Could you automate them with a template? The possibilities are endless!\nStep 1: Prep the Template Directory First things first, let‚Äôs get Mold up and running on your system. It‚Äôs a quick and easy installation from the PowerShell Gallery:\nInstall-Module -Name Mold Now, let‚Äôs set the stage for our PowerShell script template. We‚Äôll call our directory PowerScript, all the code in their is boilerplate code that I added manually on my own.\nPowerScript ‚îú‚îÄ‚îÄ Docs ‚îÇ ‚îî‚îÄ‚îÄ README.md ‚îî‚îÄ‚îÄ script.ps1 Here‚Äôs the content of script.ps1:\nthe Readme.md file and its content\nStep 2 : Add Placeholders Time to make our template dynamic! Let‚Äôs update script.ps1 and README.md with Mold‚Äôs placeholder magic\nAnd this README.md as below\nStep 3 : Generate MoldManifest and Update fields Now that we‚Äôve added placeholders, let‚Äôs create the MoldManifest.json file, Just run the following command, either from within your PowerScript directory or by specifying its full path:\n# Generate Mold Manifest New-MoldManifest -Path ./PowerScript After running the command, you‚Äôll find the following MoldManifest.json file in your PowerScript directory:\nThis file is the backbone of your template. It defines the questions Mold will ask when the template is invoked. You can customize this file further to tailor your template to your exact needs.\nRemember, you can personalize the ‚ÄúMessage,‚Äù ‚ÄúPrompt,‚Äù ‚ÄúCaption,‚Äù and ‚ÄúChoices/Description‚Äù fields to provide even clearer context for your questions. Make this template truly yours!\nStep 3.5 : Supercharge Your Template with MOLD_SCRIPT (Optional, but Oh So Powerful) What if you want your template to do more than just swap out text? Maybe you need to rename files, tweak content based on user input, or perform some other scripting wizardry. That‚Äôs where MOLD_SCRIPT.ps1 steps in! This special file is Mold‚Äôs secret weapon for executing custom logic at the end of the template deployment process.\nIn our example, we‚Äôll use MOLD_SCRIPT.ps1 to rename the generic script.ps1 file to something more meaningful, based on the input we gather from the user.\nAll user-provided data is consolidated within the $MoldData variable, accessible for use within your custom logic. To maintain system integrity, scripts operate in an isolated environment, able to modify only template content and not the file/content already present in final output directory.\nStep 4 : Ready to roll You‚Äôve just built a reusable template that can effortlessly crank out new PowerShell scripts. Now, let‚Äôs explore the different ways you can put this template to work.\nManually point to path ‚Äã\tIf you just need one-off template run or running someone else‚Äôs template, you can always manually point to the template directory. This method gives you full control over where Mold looks for your template. Just remember, you‚Äôll need to specify the full path each time.\n# Full path to template directory Invoke-Mold -TemplatePath \"/Some/Path/to/Template/PowerScript\" # If you donot provide destination path, template will be deployed to current working directory Add to MOLDTEMPLATES environment path\nMy favorite way to store templates is in the MOLDTEMPLATES environment variable. It‚Äôs like a VIP lounge for your templates, offering perks like:\nTab Completion: Never fumble for file paths again, you can invoke templates by name Multiple Paths: Add as many template directories as you want, just separate them with semicolons. # invoke by name Invoke-Mold -Name PowerScript This trick is especially handy if you‚Äôre into Git version control for your templates. It‚Äôs the perfect way to keep your templates organized, easily accessible and isolated from PowerShell modules/code.\nThe Moment of Truth: Invoking Your Template You‚Äôre all set! Now, let‚Äôs see the fruits of your labor. Here‚Äôs what happens when you run the Invoke-Mold command:\nAs you can see, Mold seamlessly guides you through the template‚Äôs questions, gathers your input, and then generates a fully customized script along with its accompanying documentation. Effortless and efficient! ‚ú®\nAnswer File Not a fan of answering prompts? Or perhaps you‚Äôre looking to automate template creation within your scripts. No problem! Mold‚Äôs got you covered with answer files.\nYou can easily generate a template for your answer file using the New-MoldAnswerFile command, providing either the template path or its name.\nHere‚Äôs a simple example of an answer file for our script template, the only required elements here is Key and Answer all other fields are there to provide you better context.\nWith this file in hand, you can feed it to the Invoke-Mold command and watch it execute without any manual intervention. It‚Äôs the perfect way to streamline your templating workflow and achieve hands-off automation!\n# invoke with AnswerFile Invoke-Mold -TemplatePath .\\PowerScript -AnswerFile .\\Mold_Answer_File.json And the Results Are In! Here‚Äôs a sneak peek at the final output after running the command:\nAs you can see, Mold not only replaced placeholders with your answers but also worked its magic behind the scenes. It renamed script.ps1 to SystemUptime.ps1, injected a helpful script header, and even updated the filename within the help content. Now that‚Äôs what I call a smart template!\nEven Markdown file was updated in Docs folder\nüì¢ Mold Community Call-Out! Mold is an open-source project, and I‚Äôm always eager for your input! Whether you have a cool template idea, a feature request, or you‚Äôve encountered a bug, I‚Äôd love to hear from you.\nSwing by the Mold GitHub repository and let‚Äôs make Mold even more awesome together! Submit your ideas, report issues, or even contribute code. Let‚Äôs build a vibrant community of Mold enthusiasts! üí™\nüôå Conclusion With Mold, you‚Äôre not just creating templates; you‚Äôre crafting a toolbox of productivity boosters. üöÄ\nIf you encounter any issues or have suggestions, don‚Äôt hesitate to open an issue. Your voice matters, Let‚Äôs shape the future of PowerShell templating!\nThank you so much, happy scripting!\n","wordCount":"1685","inLanguage":"en","datePublished":"2024-07-12T17:36:31-03:00","dateModified":"2024-07-12T17:36:31-03:00","author":{"@type":"Person","name":"Manjunath Beli"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.belibug.com/post/ps-mold/"},"publisher":{"@type":"Organization","name":"Beli's blog","logo":{"@type":"ImageObject","url":"https://blog.belibug.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.belibug.com/ accesskey=h title="Beli's blog (Alt + H)">Beli's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.belibug.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.belibug.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.belibug.com/>Home</a>&nbsp;¬ª&nbsp;<a href=https://blog.belibug.com/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Introducing PowerShell Templating Engine - Mold</h1><div class=post-meta><span title='2024-07-12 17:36:31 -0300 ADT'>July 12, 2024</span>&nbsp;¬∑&nbsp;8 min&nbsp;¬∑&nbsp;Manjunath Beli</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#-whats-templating--why-should-you-care>üå± What&rsquo;s Templating & Why Should You Care?</a></li><li><a href=#-cant-wait-to-get-started>üöÄ Can&rsquo;t Wait to Get Started?</a></li><li><a href=#the-why>The Why?</a></li><li><a href=#the-how>The How?</a></li><li><a href=#example-project---powershell-script-template-for-new-scripts>Example Project - PowerShell Script Template for new Scripts</a><ul><li><a href=#step-1-prep-the-template-directory>Step 1: Prep the Template Directory</a></li><li><a href=#step-2--add-placeholders>Step 2 : Add Placeholders</a></li><li><a href=#step-3--generate-moldmanifest-and-update-fields>Step 3 : Generate MoldManifest and Update fields</a></li><li><a href=#step-35--supercharge-your-template-with-mold_script-optional-but-oh-so-powerful>Step 3.5 : Supercharge Your Template with MOLD_SCRIPT (Optional, but Oh So Powerful)</a></li><li><a href=#step-4--ready-to-roll>Step 4 : Ready to roll</a></li></ul></li><li><a href=#the-moment-of-truth-invoking-your-template>The Moment of Truth: Invoking Your Template</a><ul><li><a href=#answer-file>Answer File</a></li></ul></li><li><a href=#and-the-results-are-in>And the Results Are In!</a></li><li><a href=#-mold-community-call-out>üì¢ <strong>Mold Community Call-Out!</strong></a></li><li><a href=#-conclusion>üôå Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h1 id=introducing-mold---the-missing-powershell-templating-engine>Introducing Mold - The Missing PowerShell Templating Engine<a hidden class=anchor aria-hidden=true href=#introducing-mold---the-missing-powershell-templating-engine>#</a></h1><p>Mold is PowerShell template & scaffolding engine that lets you effortlessly craft templates for any language (not limited to PowerShell), on any platform. üöÄ Deploy in a flash with interactive prompts or answer files ‚Äì your choice!</p><p>Ready to see Mold work in action? Here&rsquo;s a sneak peek of what deploying a template looks like:</p><p><img loading=lazy src=./assets/image-20240712174346768.png alt=image-20240712174346768></p><h2 id=-whats-templating--why-should-you-care>üå± What&rsquo;s Templating & Why Should You Care?<a hidden class=anchor aria-hidden=true href=#-whats-templating--why-should-you-care>#</a></h2><p>Think of templates as blueprints for your code. They&rsquo;re pre-formatted files with placeholders for variables, like names, dates, blocks of code. When you use a template, you simply fill in the blanks, and voil√† ‚Äì you&rsquo;ve got a customized script or project ready to go!</p><p><strong>Why is this awesome?</strong></p><ul><li><strong>Save Time:</strong> No more writing the same boilerplate code over and over.</li><li><strong>Consistency:</strong> Templates help ensure your projects follow best practices and maintain a uniform style.</li><li><strong>Scalability:</strong> Easily create multiple projects or files from a single template.</li><li><strong>Flexibility:</strong> Customize your templates to fit your specific needs.</li></ul><p><strong>Some Practical Use Cases</strong></p><ul><li>New modules with consistent boilerplate code.</li><li>Quickly generate complex configuration files from pre-defined templates.</li><li>Build project scaffolding with a few simple commands.</li><li>Standardize documentation across your PowerShell projects.</li><li>Easy template for Minutes of meeting and personal notes.</li></ul><p>Mold is a template engine, a powerful tool that acts as a processor for your templates and data. This <a href=https://en.wikipedia.org/wiki/Template_processor>Wikipedia</a> article explains the concept of templating in depth.</p><p>In short, templating is a superpower for developers, boosting productivity and reducing errors. And with Mold, harnessing that power is easier than ever before!</p><h2 id=-cant-wait-to-get-started>üöÄ Can&rsquo;t Wait to Get Started?<a hidden class=anchor aria-hidden=true href=#-cant-wait-to-get-started>#</a></h2><p>If you&rsquo;re itching to give Mold a whirl, you can grab the module from the <a href=https://www.powershellgallery.com/packages/Mold>PowerShell Gallery</a> and explore the source code on <a href=https://github.com/belibug/Mold>GitHub</a> right now!</p><p>But wait, there&rsquo;s more! If you&rsquo;re ready to dive deeper, stick around and join me as I walk you through the step-by-step process of building a Mold template from the ground up. We&rsquo;ll cover all the key features and even deploy the template to see it in action. Let&rsquo;s get started!</p><h2 id=the-why>The Why?<a hidden class=anchor aria-hidden=true href=#the-why>#</a></h2><p><code>Mold</code> began as my own little side project to scratch a personal templating itch. But, it quickly blossomed into something bigger ‚Äì a solution to a longstanding gap in the PowerShell ecosystem. Now, I know what you&rsquo;re thinking: &ldquo;We&rsquo;ve got Plaster, right?&rdquo; And yes, while Plaster has served the community well, I believe there&rsquo;s room for a fresh approach. Let&rsquo;s dive into why I think a new templating engine is not only welcome but necessary. üòâ</p><ul><li><p>While Plaster&rsquo;s deep ties to PowerShell offer undeniable advantages, they also come with certain constraints. I aimed to create something more versatile ‚Äì a tool that treats text as its playground, regardless of language.</p></li><li><p>Let&rsquo;s face it, Plaster&rsquo;s PowerShell 7 support is&mldr; well, underwhelming. üòû It&rsquo;s been gathering dust for years and demands those long, convoluted XML files that nobody enjoys writing.</p></li></ul><h2 id=the-how>The How?<a hidden class=anchor aria-hidden=true href=#the-how>#</a></h2><p>ü§î <strong>Still Here?</strong> Alright, I see you&rsquo;re intrigued. Perhaps you&rsquo;re even starting to agree that a fresh templating engine is not that bad idea after all. Let&rsquo;s unveil what Mold brings to the table, shall we?</p><p>You can find a deep dive into Mold&rsquo;s concepts, installation, usage, and even some pro tips on our <a href=https://github.com/belibug/Mold>GitHub repository</a>. I encourage you to even scour through the actual code to get a feel for how Mold works under the hood.</p><p>This blog post will focus on a hands-on walkthrough of crafting and deploying your very own Mold templates. So, buckle up and get ready to mold some code!</p><h2 id=example-project---powershell-script-template-for-new-scripts>Example Project - PowerShell Script Template for new Scripts<a hidden class=anchor aria-hidden=true href=#example-project---powershell-script-template-for-new-scripts>#</a></h2><blockquote><p>I spin up new PowerShell scripts all the time, whether just for quickly experimenting and testing things out, or for projects that I know will be around for a while. There‚Äôs a few basic things that I like all my scripts to have. - Daniel Schroeder</p></blockquote><p>Lets tackle this challenge. I wanted a bare-bones script template that delivers the essentials:</p><ul><li><strong><code>script.ps1</code>:</strong> A file with a name that perfectly matches its purpose, along with a basic script structure.</li><li><strong><code>Docs</code> :</strong> A dedicated folder to hold extra files related to script.</li><li><strong><code>README.md</code>:</strong> A markdown file within the <code>Docs</code> folder for documenting the script&rsquo;s purpose/instruction.</li></ul><blockquote><p><strong>NOTE:</strong> This example is intentionally simple (although less practical), designed to illustrate Mold&rsquo;s core concepts and functionality. In real-world scenarios, your templates can be far more complex and tailored to your specific needs.</p><p>Let your imagination run wild! üåà Think about the repetitive tasks in your PowerShell projects. Could you automate them with a template? The possibilities are endless!</p></blockquote><h3 id=step-1-prep-the-template-directory>Step 1: Prep the Template Directory<a hidden class=anchor aria-hidden=true href=#step-1-prep-the-template-directory>#</a></h3><p>First things first, let&rsquo;s get Mold up and running on your system. It&rsquo;s a quick and easy installation from the PowerShell Gallery:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>Mold</span>
</span></span></code></pre></div><p>Now, let&rsquo;s set the stage for our PowerShell script template. We&rsquo;ll call our directory <code>PowerScript</code>, all the code in their is boilerplate code that I added manually on my own.</p><pre tabindex=0><code>PowerScript
‚îú‚îÄ‚îÄ Docs
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ script.ps1
</code></pre><p>Here&rsquo;s the content of <code>script.ps1</code>:</p><p><img loading=lazy src=./assets/image-20240710163822217.png alt=image-20240710163822217></p><p>the Readme.md file and its content</p><p><img loading=lazy src=./assets/image-20240710163949940.png alt=image-20240710163949940></p><h3 id=step-2--add-placeholders>Step 2 : Add Placeholders<a hidden class=anchor aria-hidden=true href=#step-2--add-placeholders>#</a></h3><p>Time to make our template dynamic! Let&rsquo;s update <code>script.ps1</code> and <code>README.md</code> with <a href="https://github.com/belibug/Mold?tab=readme-ov-file#placeholders">Mold&rsquo;s placeholder</a> magic</p><p><img loading=lazy src=./assets/image-20240710164811003.png alt=image-20240710164811003></p><p>And this <code>README.md</code> as below</p><p><img loading=lazy src=./assets/image-20240710165024811.png alt=image-20240710165024811></p><h3 id=step-3--generate-moldmanifest-and-update-fields>Step 3 : Generate MoldManifest and Update fields<a hidden class=anchor aria-hidden=true href=#step-3--generate-moldmanifest-and-update-fields>#</a></h3><p>Now that we&rsquo;ve added placeholders, let&rsquo;s create the <code>MoldManifest.json</code> file, Just run the following command, either from within your <code>PowerScript</code> directory or by specifying its full path:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Generate Mold Manifest</span>
</span></span><span class=line><span class=cl><span class=nb>New-MoldManifest</span> <span class=n>-Path</span> <span class=p>./</span><span class=n>PowerScript</span>
</span></span></code></pre></div><p>After running the command, you&rsquo;ll find the following <code>MoldManifest.json</code> file in your <code>PowerScript</code> directory:</p><p>This file is the backbone of your template. It defines the questions Mold will ask when the template is invoked. You can customize this file further to tailor your template to your exact needs.</p><p><img loading=lazy src=./assets/image-20240712002242817.png alt=image-20240712002242817></p><p>Remember, you can personalize the &ldquo;Message,&rdquo; &ldquo;Prompt,&rdquo; &ldquo;Caption,&rdquo; and &ldquo;Choices/Description&rdquo; fields to provide even clearer context for your questions. Make this template truly yours!</p><h3 id=step-35--supercharge-your-template-with-mold_script-optional-but-oh-so-powerful>Step 3.5 : Supercharge Your Template with MOLD_SCRIPT (Optional, but Oh So Powerful)<a hidden class=anchor aria-hidden=true href=#step-35--supercharge-your-template-with-mold_script-optional-but-oh-so-powerful>#</a></h3><p>What if you want your template to do more than just swap out text? Maybe you need to rename files, tweak content based on user input, or perform some other scripting wizardry. That&rsquo;s where <code>MOLD_SCRIPT.ps1</code> steps in! This special file is Mold&rsquo;s secret weapon for executing custom logic at the end of the template deployment process.</p><p>In our example, we&rsquo;ll use <code>MOLD_SCRIPT.ps1</code> to rename the generic <code>script.ps1</code> file to something more meaningful, based on the input we gather from the user.</p><p><img loading=lazy src=./assets/image-20240712004742971.png alt=image-20240712004742971></p><p>All user-provided data is consolidated within the <code>$MoldData</code> variable, accessible for use within your custom logic. To maintain system integrity, scripts operate in an isolated environment, able to modify only template content and not the file/content already present in final output directory.</p><h3 id=step-4--ready-to-roll>Step 4 : Ready to roll<a hidden class=anchor aria-hidden=true href=#step-4--ready-to-roll>#</a></h3><p>You&rsquo;ve just built a reusable template that can effortlessly crank out new PowerShell scripts. Now, let&rsquo;s explore the different ways you can put this template to work.</p><ol><li>Manually point to path</li></ol><p>‚Äã If you just need one-off template run or running someone else‚Äôs template, you can always manually point to the template directory. This method gives you full control over where Mold looks for your template. Just remember, you&rsquo;ll need to specify the full path each time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=c># Full path to template directory</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Mold</span> <span class=n>-TemplatePath</span> <span class=s2>&#34;/Some/Path/to/Template/PowerScript&#34;</span>
</span></span><span class=line><span class=cl><span class=c># If you donot provide destination path, template will be deployed to current working directory</span>
</span></span></code></pre></div><ol start=2><li><p>Add to <code>MOLDTEMPLATES</code> environment path</p><p>My favorite way to store templates is in the <code>MOLDTEMPLATES</code> environment variable. It&rsquo;s like a VIP lounge for your templates, offering perks like:</p><ul><li><strong>Tab Completion:</strong> Never fumble for file paths again, you can invoke templates by name</li><li><strong>Multiple Paths:</strong> Add as many template directories as you want, just separate them with semicolons.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># invoke by name</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Mold</span> <span class=n>-Name</span> <span class=n>PowerScript</span>
</span></span></code></pre></div><p>This trick is especially handy if you&rsquo;re into Git version control for your templates. It&rsquo;s the perfect way to keep your templates organized, easily accessible and isolated from PowerShell modules/code.</p></li></ol><h2 id=the-moment-of-truth-invoking-your-template>The Moment of Truth: Invoking Your Template<a hidden class=anchor aria-hidden=true href=#the-moment-of-truth-invoking-your-template>#</a></h2><p>You&rsquo;re all set! Now, let&rsquo;s see the fruits of your labor. Here&rsquo;s what happens when you run the <code>Invoke-Mold</code> command:</p><p>As you can see, Mold seamlessly guides you through the template&rsquo;s questions, gathers your input, and then generates a fully customized script along with its accompanying documentation. Effortless and efficient! ‚ú®</p><p><img loading=lazy src=./assets/image-20240712005417595.png alt=image-20240712005417595></p><h3 id=answer-file>Answer File<a hidden class=anchor aria-hidden=true href=#answer-file>#</a></h3><p>Not a fan of answering prompts? Or perhaps you&rsquo;re looking to automate template creation within your scripts. No problem! Mold&rsquo;s got you covered with answer files.</p><p>You can easily generate a template for your answer file using the <code>New-MoldAnswerFile</code> command, providing either the template path or its name.</p><p>Here&rsquo;s a simple example of an answer file for our script template, the only required elements here is <code>Key</code> and <code>Answer</code> all other fields are there to provide you better context.</p><p><img loading=lazy src=./assets/image-20240712010558465.png alt=image-20240712010558465></p><p>With this file in hand, you can feed it to the <code>Invoke-Mold</code> command and watch it execute without any manual intervention. It&rsquo;s the perfect way to streamline your templating workflow and achieve hands-off automation!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># invoke with AnswerFile</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Mold</span> <span class=n>-TemplatePath</span> <span class=p>.\</span><span class=n>PowerScript</span> <span class=n>-AnswerFile</span> <span class=p>.\</span><span class=n>Mold_Answer_File</span><span class=p>.</span><span class=py>json</span>
</span></span></code></pre></div><h2 id=and-the-results-are-in>And the Results Are In!<a hidden class=anchor aria-hidden=true href=#and-the-results-are-in>#</a></h2><p>Here&rsquo;s a sneak peek at the final output after running the command:</p><p>As you can see, Mold not only replaced placeholders with your answers but also worked its magic behind the scenes. It renamed <code>script.ps1</code> to <code>SystemUptime.ps1</code>, injected a helpful script header, and even updated the filename within the help content. Now that&rsquo;s what I call a smart template!</p><p><img loading=lazy src=./assets/image-20240712005854047.png alt=image-20240712005854047></p><p>Even Markdown file was updated in Docs folder</p><p><img loading=lazy src=./assets/image-20240712011014106.png alt=image-20240712011014106></p><h2 id=-mold-community-call-out>üì¢ <strong>Mold Community Call-Out!</strong><a hidden class=anchor aria-hidden=true href=#-mold-community-call-out>#</a></h2><p>Mold is an open-source project, and I&rsquo;m always eager for your input! Whether you have a cool template idea, a feature request, or you&rsquo;ve encountered a bug, I&rsquo;d love to hear from you.</p><p>Swing by the Mold GitHub repository and let&rsquo;s make Mold even more awesome together! Submit your ideas, report issues, or even contribute code. Let&rsquo;s build a vibrant community of Mold enthusiasts! üí™</p><h2 id=-conclusion>üôå Conclusion<a hidden class=anchor aria-hidden=true href=#-conclusion>#</a></h2><p>With Mold, you&rsquo;re not just creating templates; you&rsquo;re crafting a toolbox of productivity boosters. üöÄ</p><p>If you encounter any issues or have suggestions, don&rsquo;t hesitate to open an issue. Your voice matters, Let&rsquo;s shape the future of PowerShell templating!</p><p>Thank you so much, happy scripting!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.belibug.com/tags/guide/>Guide</a></li><li><a href=https://blog.belibug.com/tags/tool/>Tool</a></li><li><a href=https://blog.belibug.com/tags/psgallery/>Psgallery</a></li><li><a href=https://blog.belibug.com/tags/code/>Code</a></li><li><a href=https://blog.belibug.com/tags/powershell/>Powershell</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>