<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Taking Your PowerShell Module to PSGallery, A Simple Guide | Beli's blog</title>
<meta name=keywords content="guide,powershell,pwsh,psgallery,code"><meta name=description content="From Script to Shared Success, Publishing on the PowerShell Gallery"><meta name=author content="Manjunath Beli"><link rel=canonical href=https://blog.belibug.com/post/ps-psgallery/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.belibug.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.belibug.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.belibug.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.belibug.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.belibug.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.belibug.com/post/ps-psgallery/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EKBBBJE5PX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EKBBBJE5PX")}</script><meta property="og:title" content="Taking Your PowerShell Module to PSGallery, A Simple Guide"><meta property="og:description" content="From Script to Shared Success, Publishing on the PowerShell Gallery"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.belibug.com/post/ps-psgallery/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-06-25T23:06:07-03:00"><meta property="article:modified_time" content="2024-06-25T23:06:07-03:00"><meta property="og:site_name" content="Beli's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Taking Your PowerShell Module to PSGallery, A Simple Guide"><meta name=twitter:description content="From Script to Shared Success, Publishing on the PowerShell Gallery"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.belibug.com/post/"},{"@type":"ListItem","position":2,"name":"Taking Your PowerShell Module to PSGallery, A Simple Guide","item":"https://blog.belibug.com/post/ps-psgallery/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Taking Your PowerShell Module to PSGallery, A Simple Guide","name":"Taking Your PowerShell Module to PSGallery, A Simple Guide","description":"From Script to Shared Success, Publishing on the PowerShell Gallery","keywords":["guide","powershell","pwsh","psgallery","code"],"articleBody":"Transitioning from writing individual scripts to creating a PowerShell module is a small step with significant rewards. Once you’ve crafted your own module, the possibilities are endless. However, why stop there when you can share your module with the world through a public repository like PSGallery? Publishing your modules to public registries offers numerous advantages.\nI published my own Module last week, check it out for reference SecretBackup - PSgallery\nWhy publish You might think your module is too niche, not well-organized, or come up with countless reasons to avoid going public. However, there are several benefits to publishing your module:\nEncourages you to remove private or personally identifiable code from your module.\nPrompts you to generalize the module so it works on any machine.\nProvides an opportunity to learn about APIs and the PSGallery contribution process.\nEnhances your skills with Git and platforms like GitHub or GitLab when creating a public repository to share your code.\nHelps you adhere to best practices in coding and module development.\nEnhances communication skills by learning to express your ideas clearly.\nEstablishes a public profile for yourself and fosters contributions to the community\nSample Module on PowerShell Gallery. Everything from source, tests and build scripts are in the repo. Shows how simple and automated publishing module to PSGallery can be!\nHow to get started There are several guides available on how to write and publish modules to PSGallery, with one of the best being the Microsoft Docs guide. This article aims to provide you with the essential basics to help you get started.\nPrepare Module First you have to get the module ready and meet PSGallery standards. One can get by a simple local module with just .psm1 file. This will not be sufficient for PSGallery. Below are minim requirement for PSGallery module.\nManifest File Your module must include a manifest file (.psd1). This file contains the metadata for your module and requires several fields to be updated to meet PSGallery requirements. All the information displayed on PSGallery is retrieved from the content of the .psd1 file. Key fields to update include:\nModule Name Version (using Semantic Versioning) Tags (for visibility and searchability) Project URI (optional but recommended) You can create a template manifest file using the New-ModuleManifest cmdlet. This template serves as a reference for all the fields you can update. It’s best to populate as much information as possible to ensure your module is well-documented and easily discoverable.\nWrite Help Local modules often don’t receive much attention when it comes to documentation, as they are typically used by you or a small team nearby. However, a complete stranger on the other side of the world won’t have any idea how to run or use the commands in your module. Therefore, it’s crucial to write detailed help for each function, complete with examples. There are two key places where you can provide this explanation for your module:\nComment-Based Help: Used to provide detailed help for individual commands within the module. Repository README Page: Contains descriptions of the module, its approach, design decisions, and roadmap. Module Structure This is optional initially, but quickly becomes crucial, especially when others want to contribute. If your entire module is contained within a single psm1 file, understanding and contributing to it becomes nearly impossible. There are several methods and best practices for structuring a module, such as this one by Kevin Marauette, that help create readable and easy-to-collaborate modules.\nI have a Module built just to make building module simple and efficient. Check out ModuleTools. You can download the ModuleTools from [PSGallery](https://www.powershellgallery.com/packages/ModuleTools.\nInstall-Module -Name ModuleTools Code Quality and Testing Parameter naming conventions, function naming conventions, and even the content in your help files become crucial when sharing code with others. Writing code that is easy for others to read also makes it easier for you to revisit and understand years later.\nTesting is initially optional but becomes crucial when ensuring your module doesn’t break on other machines. Pester tests simplify running tests (easy to run as CI) and help ensure that adding or modifying code doesn’t affect existing functions.\nPester syntax might seem daunting to get started, but once you get the basics it becomes as simple as any PowerShell script.\nPublish Locally Set up a local file share-based Private NuGet repository on your machine and practice publishing to it. This will help you become proficient before you’re ready to publish to PSGallery.\nConclusion In conclusion, publishing your PowerShell module to PSGallery opens up a world of opportunities. By following best practices in module development, writing clear documentation, and incorporating testing, you not only enhance your module’s usability but also contribute positively to the community. Embrace the journey from writing scripts to creating modules—it’s a rewarding experience that strengthens your coding skills and fosters collaboration with others worldwide. Start sharing your creations today and see how your contributions can make a difference. Happy coding!\n","wordCount":"817","inLanguage":"en","datePublished":"2024-06-25T23:06:07-03:00","dateModified":"2024-06-25T23:06:07-03:00","author":{"@type":"Person","name":"Manjunath Beli"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.belibug.com/post/ps-psgallery/"},"publisher":{"@type":"Organization","name":"Beli's blog","logo":{"@type":"ImageObject","url":"https://blog.belibug.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.belibug.com/ accesskey=h title="Beli's blog (Alt + H)">Beli's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.belibug.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.belibug.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.belibug.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.belibug.com/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Taking Your PowerShell Module to PSGallery, A Simple Guide</h1><div class=post-meta><span title='2024-06-25 23:06:07 -0300 ADT'>June 25, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Manjunath Beli</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#why-publish>Why publish</a></li><li><a href=#how-to-get-started>How to get started</a><ul><li><a href=#prepare-module>Prepare Module</a></li><li><a href=#manifest-file>Manifest File</a></li><li><a href=#write-help>Write Help</a></li><li><a href=#module-structure>Module Structure</a></li><li><a href=#code-quality-and-testing>Code Quality and Testing</a></li><li><a href=#publish-locally>Publish Locally</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p>Transitioning from writing individual scripts to creating a PowerShell module is a small step with significant rewards. Once you&rsquo;ve crafted your own module, the possibilities are endless. However, why stop there when you can share your module with the world through a public repository like PSGallery? Publishing your modules to public registries offers numerous advantages.</p><p><img loading=lazy src=./assets/image-20240622000827004.png alt=image-20240622000827004></p><blockquote><p>I published my own Module last week, check it out for reference <a href=https://www.powershellgallery.com/packages/SecretBackup>SecretBackup - PSgallery</a></p></blockquote><h2 id=why-publish>Why publish<a hidden class=anchor aria-hidden=true href=#why-publish>#</a></h2><p>You might think your module is too niche, not well-organized, or come up with countless reasons to avoid going public. However, there are several benefits to publishing your module:</p><ol><li><p>Encourages you to remove private or personally identifiable code from your module.</p></li><li><p>Prompts you to generalize the module so it works on any machine.</p></li><li><p>Provides an opportunity to learn about APIs and the PSGallery contribution process.</p></li><li><p>Enhances your skills with Git and platforms like GitHub or GitLab when creating a public repository to share your code.</p></li><li><p>Helps you adhere to best practices in coding and module development.</p></li><li><p>Enhances communication skills by learning to express your ideas clearly.</p></li><li><p>Establishes a public profile for yourself and fosters contributions to the community</p></li></ol><blockquote><p>Sample Module on PowerShell Gallery. Everything from source, tests and build scripts are in the repo. Shows how simple and automated publishing module to PSGallery can be!</p></blockquote><p><img loading=lazy src=./assets/image-20240626224125116.png alt=image-20240626224125116></p><h2 id=how-to-get-started>How to get started<a hidden class=anchor aria-hidden=true href=#how-to-get-started>#</a></h2><p>There are several guides available on how to write and publish modules to PSGallery, with one of the best being the <a href=https://learn.microsoft.com/en-us/powershell/gallery/how-to/publishing-packages/publishing-a-package>Microsoft Docs guide</a>. This article aims to provide you with the essential basics to help you get started.</p><h3 id=prepare-module>Prepare Module<a hidden class=anchor aria-hidden=true href=#prepare-module>#</a></h3><p>First you have to get the module ready and meet PSGallery standards. One can get by a simple local module with just <code>.psm1</code> file. This will not be sufficient for PSGallery. Below are minim requirement for PSGallery module.</p><h3 id=manifest-file>Manifest File<a hidden class=anchor aria-hidden=true href=#manifest-file>#</a></h3><p>Your module must include a manifest file (<code>.psd1</code>). This file contains the metadata for your module and requires several fields to be updated to meet PSGallery requirements. All the information displayed on PSGallery is retrieved from the content of the <code>.psd1</code> file. Key fields to update include:</p><ul><li><strong>Module Name</strong></li><li><strong>Version</strong> (using Semantic Versioning)</li><li><strong>Tags</strong> (for visibility and searchability)</li><li><strong>Project URI</strong> (optional but recommended)</li></ul><p>You can create a template manifest file using the <code>New-ModuleManifest</code> cmdlet. This template serves as a reference for all the fields you can update. It&rsquo;s best to populate as much information as possible to ensure your module is well-documented and easily discoverable.</p><h3 id=write-help>Write Help<a hidden class=anchor aria-hidden=true href=#write-help>#</a></h3><p>Local modules often don&rsquo;t receive much attention when it comes to documentation, as they are typically used by you or a small team nearby. However, a complete stranger on the other side of the world won&rsquo;t have any idea how to run or use the commands in your module. Therefore, it&rsquo;s crucial to write detailed help for each function, complete with examples. There are two key places where you can provide this explanation for your module:</p><ul><li><strong>Comment-Based Help</strong>: Used to provide detailed help for individual commands within the module.</li><li><strong>Repository README Page</strong>: Contains descriptions of the module, its approach, design decisions, and roadmap.</li></ul><h3 id=module-structure>Module Structure<a hidden class=anchor aria-hidden=true href=#module-structure>#</a></h3><p>This is optional initially, but quickly becomes crucial, especially when others want to contribute. If your entire module is contained within a single <code>psm1</code> file, understanding and contributing to it becomes nearly impossible. There are several methods and best practices for structuring a module, such as <a href=https://powershellexplained.com/2017-05-27-Powershell-module-building-basics>this one</a> by Kevin Marauette, that help create readable and easy-to-collaborate modules.</p><img src=./assets/image-20240626224457877.png alt=image-20240626224457877 style=zoom:50%><p>I have a Module built just to make building module simple and efficient. Check out <a href=https://github.com/belibug/ModuleTools>ModuleTools</a>. You can download the ModuleTools from [PSGallery](<a href=https://www.powershellgallery.com/packages/ModuleTools>https://www.powershellgallery.com/packages/ModuleTools</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>ModuleTools</span>
</span></span></code></pre></div><h3 id=code-quality-and-testing>Code Quality and Testing<a hidden class=anchor aria-hidden=true href=#code-quality-and-testing>#</a></h3><p>Parameter naming conventions, function naming conventions, and even the content in your help files become crucial when sharing code with others. Writing code that is easy for others to read also makes it easier for you to revisit and understand years later.</p><p>Testing is initially optional but becomes crucial when ensuring your module doesn&rsquo;t break on other machines. Pester tests simplify running tests (easy to run as CI) and help ensure that adding or modifying code doesn&rsquo;t affect existing functions.</p><p><img loading=lazy src=./assets/image-20240626224628914.png alt=image-20240626224628914></p><p>Pester syntax might seem daunting to get started, but once you get the basics it becomes as simple as any PowerShell script.</p><h3 id=publish-locally>Publish Locally<a hidden class=anchor aria-hidden=true href=#publish-locally>#</a></h3><p>Set up a local file share-based <a href=https://learn.microsoft.com/en-us/powershell/gallery/how-to/working-with-local-psrepositories>Private NuGet repository</a> on your machine and practice publishing to it. This will help you become proficient before you&rsquo;re ready to publish to PSGallery.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>In conclusion, publishing your PowerShell module to PSGallery opens up a world of opportunities. By following best practices in module development, writing clear documentation, and incorporating testing, you not only enhance your module&rsquo;s usability but also contribute positively to the community. Embrace the journey from writing scripts to creating modules—it&rsquo;s a rewarding experience that strengthens your coding skills and fosters collaboration with others worldwide. Start sharing your creations today and see how your contributions can make a difference. Happy coding!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.belibug.com/tags/guide/>Guide</a></li><li><a href=https://blog.belibug.com/tags/powershell/>Powershell</a></li><li><a href=https://blog.belibug.com/tags/pwsh/>Pwsh</a></li><li><a href=https://blog.belibug.com/tags/psgallery/>Psgallery</a></li><li><a href=https://blog.belibug.com/tags/code/>Code</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>