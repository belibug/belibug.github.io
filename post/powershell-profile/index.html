<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Building a Modular and Maintainable PowerShell Profile | Beli's blog</title>
<meta name=keywords content="powershell,guide,tools,pwsh,code"><meta name=description content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><meta name=author content="Manjunath Beli"><link rel=canonical href=http://localhost:1313/post/powershell-profile/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/post/powershell-profile/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EKBBBJE5PX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EKBBBJE5PX")}</script><meta property="og:title" content="Building a Modular and Maintainable PowerShell Profile"><meta property="og:description" content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/post/powershell-profile/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-10T00:00:00+00:00"><meta property="og:site_name" content="Beli's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building a Modular and Maintainable PowerShell Profile"><meta name=twitter:description content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"Building a Modular and Maintainable PowerShell Profile","item":"http://localhost:1313/post/powershell-profile/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Building a Modular and Maintainable PowerShell Profile","name":"Building a Modular and Maintainable PowerShell Profile","description":"Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile","keywords":["powershell","guide","tools","pwsh","code"],"articleBody":"PowerShell profile is the most overlooked component of PowerShell. Strength of PowerShell lies in alias, modules and customization for each PowerShell session. If you have been using PowerShell to run one liners, run scripts in some shared folder, or worse use ISE for routine tasks then STOP.\nIn this article we will go through how to setup a simple profile that is fast, simple, maintainable and easy to expand.\nBasic Setup This guide is tailored for PowerShell 7, if you are running older PowerShell its highly recommended to install the latest one. Optional : Install Windows Terminal if you are on windows or any other modern terminal that supports rich ANSI support. Almost all other OS Terminals support ANSI out of box, do check documentation to be sure. Simple Profile If you have never created a profile before, you need to create one first. Execute below code in your terminal, it will create a profile if it doesn’t exists and opens it default editor.\nif (!(Test-Path -Path $PROFILE)) { New-Item -ItemType File -Path $PROFILE -Force } # Open in Default editor, choose notepad if you are prompted to select one Invoke-Item $PROFILE Profile Components This detailed guide will walk you through setting up your PowerShell profile, progressively increasing in complexity. While you don’t need to configure every component, it’s crucial to understand what can be included in your profile and how to load these elements effectively. Once you’re comfortable with the basics, revisit this page to supercharge your PowerShell profile. (PS: This is an ongoing adventure, and I’m absolutely thrilled by it!)\nCosmetics A dead giveaway that someone has customized their profile is their prompt. While the default prompt is fine for a temporary virtual machine PowerShell session, you need something unique to truly make the PowerShell prompt your own.\nHere’s a simple function that transforms a boring prompt into an eye-catching, colorful one:\nBasic prompt using powershell function\nfunction prompt { $curPath = (Get-Location).Path $curTime = Get-Date -Format 'HH:mm:ss' Write-Host $curPath -ForegroundColor Red -NoNewline Write-Host ' :: ' -NoNewline Write-Host $curTime -ForegroundColor Blue -NoNewline Write-Host ' ⚡' -NoNewline return ' ' } image-20240609225916725\nThis is just scratching the surface of what you can do with prompt, check Microsoft about_Prompt doc showcasing other options.\nThere are several pre-defined ready to use prompts if you are willing to install additional modules (like oh-my-posh) or binaries (like starship)\nFunctional Elements Alias and shortcuts Environment Variables Auto Completion and external tools Folder Structure Most article show you how to create one super long profile in a single PROFILE.ps1 file, this is good when you starting off, but it will quickly become too difficult to manage and scale.\nReference Profile Do not dwell too much on profile load time. A couple of extra milliseconds load time is perfectly reasonable tradeoff to have all the modules, autocompletions and aliases loaded and ready at fingertips.\n","wordCount":"479","inLanguage":"en","datePublished":"2024-06-10T00:00:00Z","dateModified":"2024-06-10T00:00:00Z","author":{"@type":"Person","name":"Manjunath Beli"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/post/powershell-profile/"},"publisher":{"@type":"Organization","name":"Beli's blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Beli's blog (Alt + H)">Beli's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Building a Modular and Maintainable PowerShell Profile
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-meta><span title='2024-06-10 00:00:00 +0000 UTC'>June 10, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Manjunath Beli</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#basic-setup>Basic Setup</a></li><li><a href=#simple-profile>Simple Profile</a></li><li><a href=#profile-components>Profile Components</a><ul><li><a href=#cosmetics>Cosmetics</a></li><li><a href=#functional-elements>Functional Elements</a></li><li><a href=#alias-and-shortcuts>Alias and shortcuts</a></li><li><a href=#environment-variables>Environment Variables</a></li><li><a href=#auto-completion-and-external-tools>Auto Completion and external tools</a></li></ul></li><li><a href=#folder-structure>Folder Structure</a></li><li><a href=#reference-profile>Reference Profile</a></li></ul></nav></div></details></div><div class=post-content><p>PowerShell profile is the most overlooked component of <code>PowerShell</code>. Strength of PowerShell lies in alias, modules and customization for each PowerShell session. If you have been using PowerShell to run one liners, run scripts in some shared folder, or worse use ISE for routine tasks then STOP.</p><p>In this article we will go through how to setup a simple profile that is fast, simple, maintainable and easy to expand.</p><h2 id=basic-setup>Basic Setup<a hidden class=anchor aria-hidden=true href=#basic-setup>#</a></h2><ul><li>This guide is tailored for <a href=https://github.com/PowerShell/PowerShell>PowerShell 7</a>, if you are running older PowerShell its highly recommended to install the latest one.</li><li>Optional : Install <a href=https://apps.microsoft.com/detail/9n0dx20hk701>Windows Terminal</a> if you are on windows or any other modern terminal that supports rich ANSI support. Almost all other OS Terminals support ANSI out of box, do check documentation to be sure.</li></ul><h2 id=simple-profile>Simple Profile<a hidden class=anchor aria-hidden=true href=#simple-profile>#</a></h2><p>If you have never created a profile before, you need to create one first. Execute below code in your terminal, it will create a profile if it doesn&rsquo;t exists and opens it default editor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(!(</span><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>New-Item</span> <span class=n>-ItemType</span> <span class=n>File</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># Open in Default editor, choose notepad if you are prompted to select one</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Item</span> <span class=nv>$PROFILE</span>
</span></span></code></pre></div><h2 id=profile-components>Profile Components<a hidden class=anchor aria-hidden=true href=#profile-components>#</a></h2><p>This detailed guide will walk you through setting up your PowerShell profile, progressively increasing in complexity. While you don&rsquo;t need to configure every component, it&rsquo;s crucial to understand what can be included in your profile and how to load these elements effectively. Once you&rsquo;re comfortable with the basics, revisit this page to supercharge your PowerShell profile. (PS: This is an ongoing adventure, and I&rsquo;m absolutely thrilled by it!)</p><h3 id=cosmetics>Cosmetics<a hidden class=anchor aria-hidden=true href=#cosmetics>#</a></h3><p>A dead giveaway that someone has customized their profile is their prompt. While the default prompt is fine for a temporary virtual machine PowerShell session, you need something unique to truly make the PowerShell prompt your own.</p><p>Here&rsquo;s a simple function that transforms a boring prompt into an eye-catching, colorful one:</p><p>Basic prompt using powershell function</p><p><img loading=lazy src=./assets/image-20240609225812902.png alt=image-20240609225812902></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>prompt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$curPath</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Get-Location</span><span class=p>).</span><span class=py>Path</span>
</span></span><span class=line><span class=cl>    <span class=nv>$curTime</span> <span class=p>=</span> <span class=nb>Get-Date</span> <span class=n>-Format</span> <span class=s1>&#39;HH:mm:ss&#39;</span> 
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=nv>$curPath</span> <span class=n>-ForegroundColor</span> <span class=n>Red</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s1>&#39; :: &#39;</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=nv>$curTime</span> <span class=n>-ForegroundColor</span> <span class=n>Blue</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s1>&#39; ⚡&#39;</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39; &#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><a href=./assets/image-20240609225916725.png>image-20240609225916725</a></p><p>This is just scratching the surface of what you can do with prompt, check Microsoft <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_prompts?view=powershell-7.4">about_Prompt</a> doc showcasing other options.</p><p>There are several pre-defined ready to use prompts if you are willing to install additional modules (like <a href=https://ohmyposh.dev/docs/migrating>oh-my-posh</a>) or binaries (like <a href=https://starship.rs/>starship</a>)</p><h3 id=functional-elements>Functional Elements<a hidden class=anchor aria-hidden=true href=#functional-elements>#</a></h3><h3 id=alias-and-shortcuts>Alias and shortcuts<a hidden class=anchor aria-hidden=true href=#alias-and-shortcuts>#</a></h3><h3 id=environment-variables>Environment Variables<a hidden class=anchor aria-hidden=true href=#environment-variables>#</a></h3><h3 id=auto-completion-and-external-tools>Auto Completion and external tools<a hidden class=anchor aria-hidden=true href=#auto-completion-and-external-tools>#</a></h3><h2 id=folder-structure>Folder Structure<a hidden class=anchor aria-hidden=true href=#folder-structure>#</a></h2><p>Most article show you how to create one super long profile in a single <code>PROFILE.ps1</code> file, this is good when you starting off, but it will quickly become too difficult to manage and scale.</p><h2 id=reference-profile>Reference Profile<a hidden class=anchor aria-hidden=true href=#reference-profile>#</a></h2><blockquote><p>Do not dwell too much on profile load time. A couple of extra milliseconds load time is perfectly reasonable tradeoff to have all the modules, autocompletions and aliases loaded and ready at fingertips.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/powershell/>Powershell</a></li><li><a href=http://localhost:1313/tags/guide/>Guide</a></li><li><a href=http://localhost:1313/tags/tools/>Tools</a></li><li><a href=http://localhost:1313/tags/pwsh/>Pwsh</a></li><li><a href=http://localhost:1313/tags/code/>Code</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>