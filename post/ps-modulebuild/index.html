<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Simplify PowerShell Module Development with ModuleTools | Beli's blog</title>
<meta name=keywords content="guide,powershell,pwsh,psgallery,code"><meta name=description content="From Scattered Scripts to Organized Modules,  Master the craft of creating efficient and reusable code"><meta name=author content="Manjunath Beli"><link rel=canonical href=https://blog.belibug.com/post/ps-modulebuild/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.belibug.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.belibug.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.belibug.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.belibug.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.belibug.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.belibug.com/post/ps-modulebuild/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EKBBBJE5PX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EKBBBJE5PX")}</script><meta property="og:title" content="Simplify PowerShell Module Development with ModuleTools"><meta property="og:description" content="From Scattered Scripts to Organized Modules,  Master the craft of creating efficient and reusable code"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.belibug.com/post/ps-modulebuild/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-06-21T23:06:07-03:00"><meta property="article:modified_time" content="2024-06-21T23:06:07-03:00"><meta property="og:site_name" content="Beli's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Simplify PowerShell Module Development with ModuleTools"><meta name=twitter:description content="From Scattered Scripts to Organized Modules,  Master the craft of creating efficient and reusable code"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.belibug.com/post/"},{"@type":"ListItem","position":2,"name":"Simplify PowerShell Module Development with ModuleTools","item":"https://blog.belibug.com/post/ps-modulebuild/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Simplify PowerShell Module Development with ModuleTools","name":"Simplify PowerShell Module Development with ModuleTools","description":"From Scattered Scripts to Organized Modules,  Master the craft of creating efficient and reusable code","keywords":["guide","powershell","pwsh","psgallery","code"],"articleBody":"There is no shortage of modules in the PowerShell Gallery for building modules. In fact, there are at least a dozen actively managed modules capable of building complex modules. So, you might ask, why choose ModuleTools and what makes it special? Allow me to explain.\nBuilding modules doesn’t have to be complex or an all-or-nothing process. While I have drawn a lot of inspiration from InvokeBuild and the Sampler module builder, they are overly complex and have a steep learning curve. They introduce their own assert, exec, and requires syntax that you need to learn. They depend on several other Modules (like psake, plaster).\nIntroducing ModuleTools ModuleTools employs a straightforward structure and a single data file (project.json) to manage the entire module development process. It allows you to build, run Pester tests, or perform semantic version upgrades with ease. You can customize its usage by selecting only the tasks you need, such as invoking builds while skipping tests. Additionally, the same commands work seamlessly for both local and pipeline builds.\nIt is entirely self-contained, eliminating the need for scaffolding tools (like Plaster), build tools (like Psake), or the maintenance of non-functional helper files (like psd1 and build.ps1).\nFind the source code for SecretBackup module on GitHub which will be used for reference in below examples.\nWhy Build at all? If you have built module yourself or know what you are doing, skip directly to next section\nUnlike other compiled languages, there is no formal concept of a “build” in PowerShell development. However, creating a well-organized and easy-to-manage PowerShell module requires a certain structure and organization. Build tools help achieve this by generating the necessary structure with ease.\nThe organizational structure is the most compelling reason to have a build mechanism. Instead of cramming hundreds of lines of code into a single psm1 file, it’s more efficient to give each function its own file.\nThe idea is that each file contains one function, and each function performs a single task. This approach makes files and functions easier to manage and control through versioning.\nGetting Started with ModuleTools New-MTModule is all you need to set up your project. In fewer than six interactive steps, you’ll be ready to start writing beautiful modules. Below is a screenshot of setting up a test module project.\nProject JSON file This file contains key information about the project, including everything from the module’s GUID to the Pester configuration. It is created automatically with New-MTModule, or you can copy a sample file from here.\n{ \"ProjectName\": \"ModuleName\", \"Description\": \"Description of Module\", \"Version\": \"0.0.1\", \"Manifest\": { \"Author\": \"Manjunath Beli\", \"PowerShellHostVersion\": \"7.4\", \"GUID\": \"Use New-Guid to generate guid\", \"Tags\": [], \"ProjecUri\": \"\" } } Folder Structure If you used the New-MTModule command the folder structure is already setup for you. If you like doing it manually, these are important folders\nEach folder serves a purpose\nFolder Purpose Root\\project.json This is main project info file in json format Src\\private Functions required for module but not exposed to user Src\\public Functions that are exposed in module Src\\resources Any file you want to ship with module (like config.ini image.jpg) tests all the pester tests dist auto generated, the output of ModuleTools invoke build command For instance, this is folder structure in one of my module SecretBackup\nPowerShell Functions I like to break my functions into simple, one-task-only scripts. The name of the function doesn’t matter, but each file should contain only one top level function. Everything in the public folder gets exported as module commands, while everything in the private folder is accessible within the module but not exposed to the user.\nSample Function\n# File SayHello.ps1 function Write-Greetings { Write-Host \"Hello Stranger!\" } Name of the file is not important, ensure the content of file has one top level function only.\nBuild Building a module is as simple as Invoke-MTBuild. Use -Verbose if you want to see more details during build. It takes less than a second to build.\nTests You can also easily run Tests using Invoke-MTTest. Ensure all your tests are in tests folder in root directory of project.\nAll the pester configuration can be stored in project.json which makes running pester test easy and consistent.\nOutput Output files are kept in the dist folder located in the project’s root directory. Each time you run a build, this directory is cleaned up, and the module is built from scratch.\nAutomation All configuration details are stored in project.json, which is easy to parse and use in automation. The module also includes the Get-MTProjectInfo command, which provides additional properties of the module, allowing you to easily incorporate them into Pester tests and automation.\nAll commands are terminating on error, which means you can run them sequentially for easy automation.\n# File run.ps1 ## Build Module Invoke-MTBuild ## Perform Tests Invoke-MTTest ## Publish Module Publish-PSResource -Repository PrivateOwn -path ./dist/SecretBackup This simple flow ensures that the module is published (step-3) only if the Build (step-1) and Tests (step-2) run without errors.\nGithub Actions Module builds can be easily automated using GitHub Actions since all the necessary build commands are contained within the single ModuleTools module. Simply install the module, import it, run the build, and you’re good to go.\nSample github action flow, using no 3rd party actions, on a ubuntu host.\nname: Publish to Packages # Controls when the workflow will run on: workflow_dispatch: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install ModuleTools module form PSGallery run: Install-PSResource -Repository PSGallery -Name ModuleTools -TrustRepository shell: pwsh - name: Build Module run: Invoke-MTBuild -Verbose shell: pwsh - name: Run Pester Tests run: Invoke-MTTest shell: pwsh - name: Publish Package to Github run: Publish-PSResource -Path ./dist/ModuleTools -Repository PSGallery -ApiKey $Env:ApiKey env: ApiKey: ${{ secrets.PSGALLERY_API }} shell: pwsh Conclusion In conclusion, ModuleTools simplifies PowerShell module development by offering a straightforward approach to organizing functions into single-task scripts, managed through a unified project.json configuration.\nWith ModuleTools, you can easily transform your scattered or lengthy scripts into the well-structured modules you’ve always aimed for.\nGot ideas or feedback? Drop them in github issues/discussion! Let’s make building PowerShell modules easier and more awesome together.\n","wordCount":"1018","inLanguage":"en","datePublished":"2024-06-21T23:06:07-03:00","dateModified":"2024-06-21T23:06:07-03:00","author":{"@type":"Person","name":"Manjunath Beli"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.belibug.com/post/ps-modulebuild/"},"publisher":{"@type":"Organization","name":"Beli's blog","logo":{"@type":"ImageObject","url":"https://blog.belibug.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.belibug.com/ accesskey=h title="Beli's blog (Alt + H)">Beli's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.belibug.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.belibug.com/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.belibug.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.belibug.com/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Simplify PowerShell Module Development with ModuleTools</h1><div class=post-meta><span title='2024-06-21 23:06:07 -0300 ADT'>June 21, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Manjunath Beli</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introducing-moduletools>Introducing ModuleTools</a></li><li><a href=#why-build-at-all>Why Build at all?</a></li><li><a href=#getting-started-with-moduletools>Getting Started with ModuleTools</a><ul><li><a href=#project-json-file>Project JSON file</a></li><li><a href=#folder-structure>Folder Structure</a></li><li><a href=#powershell-functions>PowerShell Functions</a></li><li><a href=#build>Build</a></li><li><a href=#tests>Tests</a></li><li><a href=#output>Output</a></li><li><a href=#automation>Automation</a></li></ul></li><li><a href=#github-actions>Github Actions</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p>There is no shortage of modules in the PowerShell Gallery for building modules. In fact, there are at least a dozen actively managed modules capable of building complex modules. So, you might ask, why choose <code>ModuleTools</code> and what makes it special? Allow me to explain.</p><p>Building modules doesn&rsquo;t have to be complex or an all-or-nothing process. While I have drawn a lot of inspiration from <code>InvokeBuild</code> and the <code>Sampler</code> module builder, they are overly complex and have a steep learning curve. They introduce their own <code>assert</code>, <code>exec</code>, and <code>requires</code> syntax that you need to learn. They depend on several other Modules (like psake, plaster).</p><h2 id=introducing-moduletools>Introducing ModuleTools<a hidden class=anchor aria-hidden=true href=#introducing-moduletools>#</a></h2><p><a href=https://github.com/belibug/ModuleTools>ModuleTools</a> employs a straightforward structure and a single data file (project.json) to manage the entire module development process. It allows you to build, run Pester tests, or perform semantic version upgrades with ease. You can customize its usage by selecting only the tasks you need, such as invoking builds while skipping tests. Additionally, the same commands work seamlessly for both local and pipeline builds.</p><p>It is entirely self-contained, eliminating the need for scaffolding tools (like Plaster), build tools (like Psake), or the maintenance of non-functional helper files (like psd1 and build.ps1).</p><blockquote><p>Find the source code for <a href=https://www.powershellgallery.com/packages/SecretBackup>SecretBackup</a> module on <a href=https://github.com/belibug/SecretBackup>GitHub</a> which will be used for reference in below examples.</p></blockquote><h2 id=why-build-at-all>Why Build at all?<a hidden class=anchor aria-hidden=true href=#why-build-at-all>#</a></h2><blockquote><p>If you have built module yourself or know what you are doing, skip directly to next section</p></blockquote><p>Unlike other compiled languages, there is no formal concept of a &ldquo;build&rdquo; in PowerShell development. However, creating a well-organized and easy-to-manage PowerShell module requires a certain structure and organization. Build tools help achieve this by generating the necessary structure with ease.</p><p>The organizational structure is the most compelling reason to have a build mechanism. Instead of cramming hundreds of lines of code into a single <code>psm1</code> file, it&rsquo;s more efficient to give each function its own file.</p><img src=./assets/image-20240627001038354.png alt=image-20240627001038354 style=zoom:50%><p>The idea is that each file contains one function, and each function performs a single task. This approach makes files and functions easier to manage and control through versioning.</p><h2 id=getting-started-with-moduletools>Getting Started with ModuleTools<a hidden class=anchor aria-hidden=true href=#getting-started-with-moduletools>#</a></h2><p><code>New-MTModule</code> is all you need to set up your project. In fewer than six interactive steps, you&rsquo;ll be ready to start writing beautiful modules. Below is a screenshot of setting up a test module project.</p><p><img loading=lazy src=./assets/image-20240627195958808.png alt=image-20240627195958808></p><h3 id=project-json-file>Project JSON file<a hidden class=anchor aria-hidden=true href=#project-json-file>#</a></h3><p>This file contains key information about the project, including everything from the module&rsquo;s GUID to the Pester configuration. It is created automatically with <code>New-MTModule</code>, or you can copy a sample file from <a href=https://github.com/belibug/ModuleTools/blob/main/example/project.json>here</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;ProjectName&#34;</span><span class=p>:</span> <span class=s2>&#34;ModuleName&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Description&#34;</span><span class=p>:</span> <span class=s2>&#34;Description of Module&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;0.0.1&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Manifest&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;Manjunath Beli&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;PowerShellHostVersion&#34;</span><span class=p>:</span> <span class=s2>&#34;7.4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;GUID&#34;</span><span class=p>:</span> <span class=s2>&#34;Use New-Guid to generate guid&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Tags&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ProjecUri&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=folder-structure>Folder Structure<a hidden class=anchor aria-hidden=true href=#folder-structure>#</a></h3><p>If you used the <code>New-MTModule</code> command the folder structure is already setup for you. If you like doing it manually, these are important folders</p><img src=./assets/image-20240627200142349.png alt=image-20240627200142349 style=zoom:40%><p>Each folder serves a purpose</p><table><thead><tr><th>Folder</th><th>Purpose</th></tr></thead><tbody><tr><td>Root\project.json</td><td>This is main project info file in json format</td></tr><tr><td>Src\private</td><td>Functions required for module but not exposed to user</td></tr><tr><td>Src\public</td><td>Functions that are exposed in module</td></tr><tr><td>Src\resources</td><td>Any file you want to ship with module (like config.ini image.jpg)</td></tr><tr><td>tests</td><td>all the pester tests</td></tr><tr><td>dist</td><td>auto generated, the output of ModuleTools invoke build command</td></tr></tbody></table><p>For instance, this is folder structure in one of my module <code>SecretBackup</code></p><img src=./assets/image-20240627200758859.png alt=image-20240627200758859 style=zoom:55%><h3 id=powershell-functions>PowerShell Functions<a hidden class=anchor aria-hidden=true href=#powershell-functions>#</a></h3><p>I like to break my functions into simple, one-task-only scripts. The name of the function doesn&rsquo;t matter, but each file should contain only one top level function. Everything in the <code>public</code> folder gets exported as module commands, while everything in the <code>private</code> folder is accessible within the module but not exposed to the user.</p><p>Sample Function</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># File SayHello.ps1</span>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Write-Greetings</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nb>Write-Host</span> <span class=s2>&#34;Hello Stranger!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Name of the file is not important, ensure the content of file has one top level function only.</p><h3 id=build>Build<a hidden class=anchor aria-hidden=true href=#build>#</a></h3><p>Building a module is as simple as <code>Invoke-MTBuild</code>. Use <code>-Verbose</code> if you want to see more details during build. It takes less than a second to build.</p><p><img loading=lazy src=./assets/image-20240627202304500.png alt=image-20240627202304500></p><h3 id=tests>Tests<a hidden class=anchor aria-hidden=true href=#tests>#</a></h3><p>You can also easily run Tests using <code>Invoke-MTTest</code>. Ensure all your tests are in <code>tests</code> folder in root directory of project.</p><p><img loading=lazy src=./assets/image-20240627202528035.png alt=image-20240627202528035></p><p>All the pester configuration can be stored in <code>project.json</code> which makes running pester test easy and consistent.</p><h3 id=output>Output<a hidden class=anchor aria-hidden=true href=#output>#</a></h3><p>Output files are kept in the <code>dist</code> folder located in the project&rsquo;s root directory. Each time you run a build, this directory is cleaned up, and the module is built from scratch.</p><p><img loading=lazy src=./assets/image-20240627202838343.png alt=image-20240627202838343></p><h3 id=automation>Automation<a hidden class=anchor aria-hidden=true href=#automation>#</a></h3><p>All configuration details are stored in <code>project.json</code>, which is easy to parse and use in automation. The module also includes the <code>Get-MTProjectInfo</code> command, which provides additional properties of the module, allowing you to easily incorporate them into Pester tests and automation.</p><p>All commands are terminating on error, which means you can run them sequentially for easy automation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># File run.ps1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>## Build Module</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-MTBuild</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>## Perform Tests</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-MTTest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>## Publish Module</span>
</span></span><span class=line><span class=cl><span class=nb>Publish-PSResource</span> <span class=n>-Repository</span> <span class=n>PrivateOwn</span> <span class=n>-path</span> <span class=p>./</span><span class=n>dist</span><span class=p>/</span><span class=n>SecretBackup</span>
</span></span></code></pre></div><p>This simple flow ensures that the module is published (step-3) only if the Build (step-1) and Tests (step-2) run without errors.</p><h2 id=github-actions>Github Actions<a hidden class=anchor aria-hidden=true href=#github-actions>#</a></h2><p>Module builds can be easily automated using GitHub Actions since all the necessary build commands are contained within the single ModuleTools module. Simply install the module, import it, run the build, and you&rsquo;re good to go.</p><p>Sample github action flow, using no 3rd party actions, on a ubuntu host.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Publish to Packages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Controls when the workflow will run</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>workflow_dispatch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install ModuleTools module form PSGallery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>Install-PSResource -Repository PSGallery -Name ModuleTools -TrustRepository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>shell</span><span class=p>:</span><span class=w> </span><span class=l>pwsh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build Module</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>Invoke-MTBuild -Verbose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>shell</span><span class=p>:</span><span class=w> </span><span class=l>pwsh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run Pester Tests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>Invoke-MTTest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>shell</span><span class=p>:</span><span class=w> </span><span class=l>pwsh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Publish Package to Github</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>Publish-PSResource -Path ./dist/ModuleTools -Repository PSGallery -ApiKey $Env:ApiKey</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ApiKey</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PSGALLERY_API }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>shell</span><span class=p>:</span><span class=w> </span><span class=l>pwsh</span><span class=w>
</span></span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>In conclusion, <code>ModuleTools</code> simplifies PowerShell module development by offering a straightforward approach to organizing functions into single-task scripts, managed through a unified <code>project.json</code> configuration.</p><p>With <code>ModuleTools</code>, you can easily transform your scattered or lengthy scripts into the well-structured modules you&rsquo;ve always aimed for.</p><p>Got ideas or feedback? Drop them in github issues/discussion! Let&rsquo;s make building PowerShell modules easier and more awesome together.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.belibug.com/tags/guide/>Guide</a></li><li><a href=https://blog.belibug.com/tags/powershell/>Powershell</a></li><li><a href=https://blog.belibug.com/tags/pwsh/>Pwsh</a></li><li><a href=https://blog.belibug.com/tags/psgallery/>Psgallery</a></li><li><a href=https://blog.belibug.com/tags/code/>Code</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>