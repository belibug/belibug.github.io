<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Building a Modular PowerShell Profile - Part 1 of 2 | Beli's blog</title>
<meta name=keywords content="powershell,guide,tools,pwsh,code"><meta name=description content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><meta name=author content="Manjunath Beli"><link rel=canonical href=http://localhost:1313/post/ps-profile-01/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/post/ps-profile-01/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-EKBBBJE5PX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EKBBBJE5PX")}</script><meta property="og:title" content="Building a Modular PowerShell Profile - Part 1 of 2"><meta property="og:description" content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/post/ps-profile-01/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-10T00:00:00+00:00"><meta property="og:site_name" content="Beli's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building a Modular PowerShell Profile - Part 1 of 2"><meta name=twitter:description content="Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"Building a Modular PowerShell Profile - Part 1 of 2","item":"http://localhost:1313/post/ps-profile-01/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Building a Modular PowerShell Profile - Part 1 of 2","name":"Building a Modular PowerShell Profile - Part 1 of 2","description":"Simplify Your Workflow, Detailed guide to setting up a Flexible PowerShell Profile","keywords":["powershell","guide","tools","pwsh","code"],"articleBody":"Profile in PowerShell is the most overlooked component of PowerShell. Strength of PowerShell lies in alias, modules and customization for each PowerShell session. If you have been using PowerShell to run one liners, run scripts in some shared folder, or worse use ISE for routine tasks then STOP.\nThis is part 1 of two part series. In this article, we will explore various customizations and configurations you can include in your profile to drastically improve your experience.\nBasic Setup This guide is tailored for PowerShell 7, if you are running older PowerShell it’s highly recommended to install the latest one. Optional : Install Windows Terminal if you are on windows or any other modern terminal that supports rich ANSI support. Terminal on mac and linux usually support this out of the box. Simple Profile If you have never created a profile before, you need to create one first. Execute below code in your terminal, it will create a profile if it doesn’t exists and opens it default editor.\nif (!(Test-Path -Path $PROFILE)) { New-Item -ItemType File -Path $PROFILE -Force } # Open in Default editor, choose notepad if you are prompted to select one Invoke-Item $PROFILE Profile Components I have broken down profile components into separate categories. This will help you keep your profile organized, readable, and easy to manage. While you don’t need to configure every component, it’s crucial to understand what can be included in your profile and how to load these elements effectively. Once you’re comfortable with the basics, revisit this page to enhance your PowerShell profile.\nI will first explain each component, and in the next article (part 2 of 2), I’ll explain how you can put them all together.\nCosmetics A dead giveaway that someone has customized their profile is their prompt. While the default prompt is fine for a temporary virtual machine PowerShell session, you need something unique to truly make the PowerShell prompt your own.\nHere’s a simple function that transforms a boring prompt into an eye-catching, colorful one:\nBasic prompt using powershell function\nfunction prompt { $curPath = (Get-Location).Path $curTime = Get-Date -Format 'HH:mm:ss' Write-Host $curPath -ForegroundColor Red -NoNewline Write-Host ' :: ' -NoNewline Write-Host $curTime -ForegroundColor Blue -NoNewline Write-Host ' ⚡' -NoNewline return ' ' } This is just scratching the surface of what you can do with prompt, check Microsoft about_Prompt doc showcasing other options.\nThere are several pre-defined ready to use prompts if you are willing to install additional modules (like oh-my-posh) or binaries (like starship)\nApart from prompt you can also customize font, font size, background, theme and various other appearance elements. This differs for each terminal app, and most settings would be part of terminal config/setting page.\nAliases Aliases are the most common use case of any shell config file. PowerShell has peculiar way of handling alias. Alias can be either part of the function/script itself or manually created one as per your need.\nThere are several aliases that are shipped along with PowerShell, check them first before creating custom ones. Most of the linux style commands already have alias defined for them.\n# Get all alias in the current session] Get-Alias You can set alias using Set-Alias command. For example if you need to set date as alias for Get-Date you can do so by below command\n# Set Alias Set-Alias -Name date -Value Get-Date What if you need date in different format, this is where it gets tricky. Unlike other shell languages PowerShell doesnt let you pass arguments or set your default parameters easily using Set-Alias. The preferred method is to simply create a function which gives host of options and possibilities. Same command with more customization, function as alias\nfunction sdate { (Get-Date).ToShortDateString() } Although alias are handy and saves you some keystrokes, I prefer tab completion. Tab completion in PowerShell is a built in feature and doesnt need any additional plugin. The more you use PowerShell the more tab completion becomes your second nature. In above example instead of setting date as alias, its much easier to run Get-D --\u003e tab and end up in Get-Date completed for you.\nNote: PowerShell is case insensitive, so get-date and Get-Date yeilds same result. I don’t type in Camel casing when I am using terminal but tab completion helps convert the command to appropriate case to make it look clean and readble.\nEnvironment Variables Depending on your operating system, environment variables can be in system, user or session context. There are several benefits of setting environment variables at session context, for one that it is only limited to your session, this means you can you can different variable for different sesison or state of session.\nFor example, you can TOKEN value for github repo change based on your starting project directory at session launch. Below is straight forward way to set session level environment that is only present in your PowerShell session. Mind you, these wont be visible to other applications/settings outside PowerShell.\n$env:TOKEN = \"xyz-token-value\" $env:EDITOR = \"nvim\" Functional Elements and Modules Now that basics are out of way, you can start adding functionality to your shell, this is where PowerShell shines. For example, you can significantly improve tab completion using a module PSReadline. This is excellant module that boosts tab completion based on history, additional helper plugins and more. It also provides you list view for predictions.\nIn this section you can add modules, customize them, set defaults and tweak configurations to match your functional requirements.\n# Assuming you have PSReadline Module installed Set-PSReadLineKeyHandler -Chord F2 -Function SwitchPredictionView Set-PSReadLineOption -EditMode Vi Screengrab of psreadline prediction in list view. Source for prediction is history .\nCompletion for external tools Several terminal CLI tools now provide completion support for PowerShell. In the past, I would often need to consult help or open the app’s official documentation on another screen. However, with tab completion, these tools now feel almost like native PowerShell commands.\nFor example, consider popular command-line utility GitHub CLI which provides easy way to access and manage GitHub repositories, issues, and pull requests directly from the terminal.\nNot all tools provide completion helper script, make sure to check documentation of tool in question\nThe GH-Cli includes a PowerShell completion script, accessible via gh completion --shell powershell. You can easily integrate this into your current terminal session, enabling tab completion for all switches and parameters of the gh CLI tool.\n# Add gh completion helper to profile gh completion -s powershell | Out-String | Invoke-Expression For applications that do not have built-in completion helpers, you can investigate whether support is available as a standalone file on the official website or if community scripts are available to add this functionality.\nBackground Tasks This approach might be controversial, but it has worked for me for a long time. Hear me out. There are certain tasks you want to run at regular intervals (or on demand), such as updating modules or downloading configuration files from a remote location. A common approach is to use scheduled tasks. This works, but it operates outside the context of the shell. Since I’m almost always in the terminal, I set these tasks to run as jobs in the background.\nNote: Running these tasks as a job is crucial. If you run them directly in your profile, the profile’s load time will significantly increase, and you will have to wait for the tasks to complete each time you start a new session.\nBenefits of running it in profile and not as scheduled job It sits in $PROFILE as PowerShell code so its easy to modify You can get status of the job at any poitn by running Get-Job If you want to run the tasks on deman, simply run . $PROFILE Easy to manage with git versioning This is how I update one of the module ModuleFast (an epic module by Justin Grote)\n$sb = { Update-PSResource -Name ModuleFast } Start-Job -ScriptBlock $sb -Name ProfileJob Using this approach you can pretty much do any time consuming activity throught you profile. I have lot more tasks running as job, like cleaning up temp directory, perform git pull on certain projects, perform winget upgrades.\nConclusion I have briefly explained each profile component and its role in improving Profile\nIn the next post, I will show you how to manage all these components, including folder structure and version control.\n","wordCount":"1392","inLanguage":"en","datePublished":"2024-06-10T00:00:00Z","dateModified":"2024-06-10T00:00:00Z","author":{"@type":"Person","name":"Manjunath Beli"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/post/ps-profile-01/"},"publisher":{"@type":"Organization","name":"Beli's blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Beli's blog (Alt + H)">Beli's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Building a Modular PowerShell Profile - Part 1 of 2
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-meta><span title='2024-06-10 00:00:00 +0000 UTC'>June 10, 2024</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Manjunath Beli</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#basic-setup>Basic Setup</a></li><li><a href=#simple-profile>Simple Profile</a></li><li><a href=#profile-components>Profile Components</a><ul><li><a href=#cosmetics>Cosmetics</a></li><li><a href=#aliases>Aliases</a></li><li><a href=#environment-variables>Environment Variables</a></li><li><a href=#functional-elements-and-modules>Functional Elements and Modules</a></li><li><a href=#completion-for-external-tools>Completion for external tools</a></li><li><a href=#background-tasks>Background Tasks</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p><code>Profile</code> in PowerShell is the most overlooked component of PowerShell. Strength of PowerShell lies in alias, modules and customization for each PowerShell session. If you have been using PowerShell to run one liners, run scripts in some shared folder, or worse use ISE for routine tasks then STOP.</p><p>This is part 1 of two part series. In this article, we will explore various customizations and configurations you can include in your profile to drastically improve your experience.</p><h2 id=basic-setup>Basic Setup<a hidden class=anchor aria-hidden=true href=#basic-setup>#</a></h2><ul><li>This guide is tailored for <a href=https://github.com/PowerShell/PowerShell>PowerShell 7</a>, if you are running older PowerShell it’s highly recommended to install the latest one.</li><li>Optional : Install <a href=https://apps.microsoft.com/detail/9n0dx20hk701>Windows Terminal</a> if you are on windows or any other modern terminal that supports rich ANSI support. Terminal on mac and linux usually support this out of the box.</li></ul><h2 id=simple-profile>Simple Profile<a hidden class=anchor aria-hidden=true href=#simple-profile>#</a></h2><p>If you have never created a profile before, you need to create one first. Execute below code in your terminal, it will create a profile if it doesn&rsquo;t exists and opens it default editor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(!(</span><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>New-Item</span> <span class=n>-ItemType</span> <span class=n>File</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># Open in Default editor, choose notepad if you are prompted to select one</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Item</span> <span class=nv>$PROFILE</span>
</span></span></code></pre></div><h2 id=profile-components>Profile Components<a hidden class=anchor aria-hidden=true href=#profile-components>#</a></h2><p>I have broken down profile components into separate categories. This will help you keep your profile organized, readable, and easy to manage. While you don&rsquo;t need to configure every component, it&rsquo;s crucial to understand what can be included in your profile and how to load these elements effectively. Once you&rsquo;re comfortable with the basics, revisit this page to enhance your PowerShell profile.</p><p>I will first explain each component, and in the next article (part 2 of 2), I&rsquo;ll explain how you can put them all together.</p><h3 id=cosmetics>Cosmetics<a hidden class=anchor aria-hidden=true href=#cosmetics>#</a></h3><p>A dead giveaway that someone has customized their profile is their prompt. While the default prompt is fine for a temporary virtual machine PowerShell session, you need something unique to truly make the PowerShell prompt your own.</p><p>Here&rsquo;s a simple function that transforms a boring prompt into an eye-catching, colorful one:</p><p>Basic prompt using powershell function</p><p><img loading=lazy src=./assets/image-20240609225812902.png alt=image-20240609225812902></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>prompt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$curPath</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Get-Location</span><span class=p>).</span><span class=py>Path</span>
</span></span><span class=line><span class=cl>    <span class=nv>$curTime</span> <span class=p>=</span> <span class=nb>Get-Date</span> <span class=n>-Format</span> <span class=s1>&#39;HH:mm:ss&#39;</span> 
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=nv>$curPath</span> <span class=n>-ForegroundColor</span> <span class=n>Red</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s1>&#39; :: &#39;</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=nv>$curTime</span> <span class=n>-ForegroundColor</span> <span class=n>Blue</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s1>&#39; ⚡&#39;</span> <span class=n>-NoNewline</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39; &#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><img loading=lazy src=./assets/image-20240609225916725.png alt=image-20240609225916725></p><p>This is just scratching the surface of what you can do with prompt, check Microsoft <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_prompts?view=powershell-7.4">about_Prompt</a> doc showcasing other options.</p><p>There are several pre-defined ready to use prompts if you are willing to install additional modules (like <a href=https://ohmyposh.dev/docs/migrating>oh-my-posh</a>) or binaries (like <a href=https://starship.rs/>starship</a>)</p><p>Apart from prompt you can also customize font, font size, background, theme and various other appearance elements. This differs for each terminal app, and most settings would be part of terminal config/setting page.</p><h3 id=aliases>Aliases<a hidden class=anchor aria-hidden=true href=#aliases>#</a></h3><p>Aliases are the most common use case of any shell config file. PowerShell has peculiar way of handling alias. Alias can be either part of the function/script itself or manually created one as per your need.</p><p>There are several aliases that are shipped along with PowerShell, check them first before creating custom ones. Most of the linux style commands already have alias defined for them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Get all alias in the current session]</span>
</span></span><span class=line><span class=cl><span class=nb>Get-Alias</span>
</span></span></code></pre></div><p><img loading=lazy src=./assets/image-20240610234651744.png alt=image-20240610234651744></p><p>You can set alias using <code>Set-Alias</code> command. For example if you need to set <code>date</code> as alias for <code>Get-Date</code> you can do so by below command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Set Alias</span>
</span></span><span class=line><span class=cl><span class=nb>Set-Alias</span> <span class=n>-Name</span> <span class=n>date</span> <span class=n>-Value</span> <span class=nb>Get-Date</span>
</span></span></code></pre></div><p><img loading=lazy src=./assets/image-20240610234907823.png alt=image-20240610234907823></p><p>What if you need date in different format, this is where it gets tricky. Unlike other shell languages PowerShell doesnt let you pass arguments or set your default parameters easily using <code>Set-Alias</code>. The preferred method is to simply create a function which gives host of options and possibilities. Same command with more customization, function as alias</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>sdate</span> <span class=p>{</span> <span class=p>(</span><span class=nb>Get-Date</span><span class=p>).</span><span class=py>ToShortDateString</span><span class=p>()</span> <span class=p>}</span>
</span></span></code></pre></div><p>Although alias are handy and saves you some keystrokes, I prefer tab completion. Tab completion in PowerShell is a built in feature and doesnt need any additional plugin. The more you use PowerShell the more tab completion becomes your second nature. In above example instead of setting <code>date</code> as alias, its much easier to run <code>Get-D --> tab</code> and end up in <code>Get-Date</code> completed for you.</p><blockquote><p><strong>Note</strong>: PowerShell is case insensitive, so <code>get-date</code> and <code>Get-Date</code> yeilds same result. I don’t type in Camel casing when I am using terminal but tab completion helps convert the command to appropriate case to make it look clean and readble.</p></blockquote><h3 id=environment-variables>Environment Variables<a hidden class=anchor aria-hidden=true href=#environment-variables>#</a></h3><p>Depending on your operating system, environment variables can be in system, user or session context. There are several benefits of setting environment variables at session context, for one that it is only limited to your session, this means you can you can different variable for different sesison or state of session.</p><p>For example, you can <code>TOKEN</code> value for github repo change based on your starting project directory at session launch. Below is straight forward way to set session level environment that is only present in your PowerShell session. Mind you, these wont be visible to other applications/settings outside PowerShell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$env:TOKEN</span>  <span class=p>=</span> <span class=s2>&#34;xyz-token-value&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$env:EDITOR</span> <span class=p>=</span> <span class=s2>&#34;nvim&#34;</span>
</span></span></code></pre></div><h3 id=functional-elements-and-modules>Functional Elements and Modules<a hidden class=anchor aria-hidden=true href=#functional-elements-and-modules>#</a></h3><p>Now that basics are out of way, you can start adding functionality to your shell, this is where PowerShell shines. For example, you can significantly improve tab completion using a module <code>PSReadline</code>. This is excellant module that boosts tab completion based on history, additional helper plugins and more. It also provides you list view for predictions.</p><p>In this section you can add modules, customize them, set defaults and tweak configurations to match your functional requirements.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Assuming you have PSReadline Module installed</span>
</span></span><span class=line><span class=cl><span class=nb>Set-PSReadLineKeyHandler</span> <span class=n>-Chord</span> <span class=n>F2</span> <span class=n>-Function</span> <span class=n>SwitchPredictionView</span>
</span></span><span class=line><span class=cl><span class=nb>Set-PSReadLineOption</span> <span class=n>-EditMode</span> <span class=n>Vi</span>
</span></span></code></pre></div><p>Screengrab of <code>psreadline</code> prediction in list view. Source for prediction is <code>history</code> .</p><p><img loading=lazy src=./assets/image-20240611234407167.png alt=image-20240611234407167></p><h3 id=completion-for-external-tools>Completion for external tools<a hidden class=anchor aria-hidden=true href=#completion-for-external-tools>#</a></h3><p>Several terminal CLI tools now provide completion support for PowerShell. In the past, I would often need to consult help or open the app&rsquo;s official documentation on another screen. However, with tab completion, these tools now feel almost like native PowerShell commands.</p><p>For example, consider popular command-line utility <a href=https://cli.github.com/>GitHub CLI</a> which provides easy way to access and manage GitHub repositories, issues, and pull requests directly from the terminal.</p><blockquote><p>Not all tools provide completion helper script, make sure to check documentation of tool in question</p></blockquote><p>The <code>GH-Cli</code> includes a PowerShell completion script, accessible via <code>gh completion --shell powershell</code>. You can easily integrate this into your current terminal session, enabling tab completion for all switches and parameters of the <code>gh</code> CLI tool.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Add gh completion helper to profile</span>
</span></span><span class=line><span class=cl><span class=n>gh</span> <span class=n>completion</span> <span class=n>-s</span> <span class=n>powershell</span> <span class=p>|</span> <span class=nb>Out-String</span> <span class=p>|</span> <span class=nb>Invoke-Expression</span>
</span></span></code></pre></div><p>For applications that do not have built-in completion helpers, you can investigate whether support is available as a standalone file on the official website or if community scripts are available to add this functionality.</p><h3 id=background-tasks>Background Tasks<a hidden class=anchor aria-hidden=true href=#background-tasks>#</a></h3><p>This approach might be controversial, but it has worked for me for a long time. Hear me out. There are certain tasks you want to run at regular intervals (or on demand), such as updating modules or downloading configuration files from a remote location. A common approach is to use scheduled tasks. This works, but it operates outside the context of the shell. Since I&rsquo;m almost always in the terminal, I set these tasks to run as jobs in the background.</p><blockquote><p><strong>Note:</strong> Running these tasks as a job is crucial. If you run them directly in your profile, the profile&rsquo;s load time will significantly increase, and you will have to wait for the tasks to complete each time you start a new session.</p></blockquote><h4 id=benefits-of-running-it-in-profile-and-not-as-scheduled-job>Benefits of running it in profile and not as scheduled job<a hidden class=anchor aria-hidden=true href=#benefits-of-running-it-in-profile-and-not-as-scheduled-job>#</a></h4><ol><li>It sits in <code>$PROFILE</code> as PowerShell code so its easy to modify</li><li>You can get status of the job at any poitn by running <code>Get-Job</code></li><li>If you want to run the tasks on deman, simply run <code>. $PROFILE</code></li><li>Easy to manage with git versioning</li></ol><p>This is how I update one of the module <a href=https://github.com/JustinGrote/ModuleFast>ModuleFast</a> (an epic module by <a href=https://github.com/JustinGrote>Justin Grote</a>)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$sb</span> <span class=p>=</span> <span class=p>{</span> <span class=nb>Update-PSResource</span> <span class=n>-Name</span> <span class=n>ModuleFast</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Start-Job</span> <span class=n>-ScriptBlock</span> <span class=nv>$sb</span> <span class=n>-Name</span> <span class=n>ProfileJob</span>
</span></span></code></pre></div><p>Using this approach you can pretty much do any time consuming activity throught you profile. I have lot more tasks running as job, like cleaning up temp directory, perform git pull on certain projects, perform winget upgrades.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>I have briefly explained each profile component and its role in improving Profile</p><p>In the next post, I will show you how to manage all these components, including folder structure and version control.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/powershell/>Powershell</a></li><li><a href=http://localhost:1313/tags/guide/>Guide</a></li><li><a href=http://localhost:1313/tags/tools/>Tools</a></li><li><a href=http://localhost:1313/tags/pwsh/>Pwsh</a></li><li><a href=http://localhost:1313/tags/code/>Code</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>